<%# ============================================
    REGISTRY PAGE — registry.ejs
    Items and claim logic come from routes/registry.js
    WHAT TO CHANGE: Edit registryItems array in routes/registry.js
    ============================================ %>

<section class="registry-section section-padded">
  <div class="container">

    <!-- Page Header -->
    <div class="section-header">
      <div class="ornament" aria-hidden="true">⬥ ─── ✦ ─── ⬥</div>
      <h1 class="section-title">Registry</h1>
      <!-- CHANGE THIS: Update registry intro text -->
      <p class="section-subtitle">Your presence is the greatest gift of all.<br>If you do wish to give, here are things we'd love.</p>
      <p class="section-subtitle-2">P.S.<br>These are all suggestions, nothing needs to match exactly if you do wish to give a gift. Feel free to shop around for better pricing!</p>
      <div class="ornament" aria-hidden="true">⬥ ─── ✦ ─── ⬥</div>
    </div>

    <!-- Registry Grid -->
    <div class="registry-grid">
      <% items.forEach(function(item) { %>
      <% const isFundItem = item.type === 'fund' || item.id === 'honeymoon-fund'; %>
      <div class="registry-card gothic-card <%= item.claimed ? 'registry-card--claimed' : '' %>" data-item-id="<%= item.id %>">

        <!-- Category Badge -->
        <div class="registry-category"><%= item.category %></div>

        <!-- Item Name -->
        <h3 class="registry-item-name"><%= item.name %></h3>

        <!-- Description -->
        <p class="registry-item-desc"><%= item.description %></p>

        <!-- Price -->
        <p class="registry-item-price">
          <span class="price-label" aria-hidden="true">✦</span>
          <%= item.price %>
        </p>

        <!-- External Link (if provided for non-fund items) -->
        <% if (item.link && !isFundItem) { %>
        <a
          href="<%= item.link %>"
          class="registry-item-link js-registry-link"
          data-item-id="<%= item.id %>"
          target="_blank"
          rel="noopener noreferrer"
        >
          View Item ↗
        </a>
        <% } %>

        <!-- Claim / Claimed State -->
        <div class="registry-claim-area">
          <% if (isFundItem) { %>
            <a
              href="<%= item.link || '/gift-fund' %>"
              class="btn btn-primary claim-btn"
              aria-label="Contribute to Honeymoon Fund"
            >
              CONTRIBUTE
            </a>
          <% } else if (item.claimed) { %>
            <div class="claimed-badge" role="status" aria-label="Purchased">
              <span aria-hidden="true">✓</span> PURCHASED
            </div>
          <% } else { %>
            <button
              class="btn btn-primary claim-btn"
              data-item-id="<%= item.id %>"
              data-item-name="<%= item.name %>"
              data-requires-link="<%= item.link ? 'true' : 'false' %>"
              data-default-label="CLAIM THIS GIFT"
              data-confirm-label="I BOUGHT THIS GIFT"
              aria-label="Claim <%= item.name %>"
            >
              CLAIM THIS GIFT
            </button>
          <% } %>
        </div>

      </div>
      <% }); %>
    </div>

  </div>
</section>

<!-- Claim success toast -->
<div class="toast" id="claim-toast" role="status" aria-live="polite" hidden>
  <span class="toast-icon" aria-hidden="true">✦</span>
  <span class="toast-message" id="toast-message"></span>
</div>
